<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Seleccione un puesto</title>
  <link rel="stylesheet" href="../layout-components.css" />
  <link rel="stylesheet" href="visual-preferences-modal.css" />
  <link rel="stylesheet" href="table-config-modal.css" />
</head>
<body>
  <div id="main">
    <!-- Botón hamburguesa -->
    <button id="menuToggle" aria-label="Abrir menú" class="menu-btn" type="button">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </button>

    <!-- Visual Preferences Button -->
    <div class="settings-dropdown">
      <button id="settingsToggle" class="visual-preferences-btn" aria-label="Visual Preferences">
        Preferencias Visuales
      </button>
      <div id="settingsMenu" class="settings-menu">
        <ul>
          <li><button id="openPreferences">Preferencias Visuales</button></li>
          <li><button id="openTableConfig">Configurar Tabla</button></li>
          <li><button id="resetSettings">Restablecer</button></li>
        </ul>
      </div>
    </div>

    <img src="assets/logo-fondo-blanco.jpg" alt="Ottech ARG" class="logo" />
       <!-- Tabla de remitos en contenido principal -->
    <div class="table-container"> 
  <table id="remitosTable">
    <!-- Colgroup para definir ancho máximo de columnas -->
    <thead>
      <tr>
        <th>Remito</th>
        <th>Fecha</th>
        <th>Cod. Cliente</th>
        <th>Razón Social</th>
        <th>Firmado</th>
      </tr>
      <tr id="filterRow">
        <th><input type="search" placeholder="Buscar Remito" class="filter-input" data-col="0" /></th>
        <th><input type="search" placeholder="Buscar Fecha" class="filter-input" data-col="1" /></th>
        <th><input type="search" placeholder="Buscar Código" class="filter-input" data-col="2" /></th>
        <th><input type="search" placeholder="Buscar Razón" class="filter-input" data-col="3" /></th>
        <th>
          <div class="filter-cell-content">
            <div class="firmado-filter-options" data-col="4">
              <span class="filter-option selected" data-value="no-firmados">No</span>
              <span class="filter-option" data-value="si-firmados">Sí</span>
              <span class="filter-option" data-value="">Todos</span>
            </div>
            <button id="refreshTableBtn" class="refresh-btn" type="button">
              <img src="assets/Refresh.png" alt="Refresh" class="refresh-icon">
            </button>
          </div>
        </th>
      </tr>
    </thead>
    <tbody>
      <!-- Filas dinámicas -->
    </tbody>
  </table>

  <!-- Pagination Controls -->
  <div id="paginationContainer" class="pagination-container" style="display: none;">
    <div class="pagination-info">
      <span id="paginationInfo">Mostrando 0 de 0 registros</span>
    </div>
    <div class="pagination-controls">
      <button id="prevPageBtn" class="pagination-btn" disabled>❮ Anterior</button>
      <div id="pageNumbers" class="page-numbers"></div>
      <button id="nextPageBtn" class="pagination-btn" disabled>Siguiente ❯</button>
    </div>
  </div>
</div>

    <!-- Menú lateral oculto que ahora incluye TODO el contenido que quieres mostrar -->
    <nav id="sideMenu" class="side-menu" aria-label="Menú lateral">
      <div class="sidebar-layout">
        <!-- Puesto selection buttons on the left side -->
        <div id="puestoButtonsContainer" class="puesto-buttons-container">
          <button id="btnPuesto0" class="puesto-button" type="button">
            <!-- Will be populated by JavaScript -->
          </button>
          <button id="btnPuesto1" class="puesto-button" type="button">
            <!-- Will be populated by JavaScript -->
          </button>
        </div>
        
        <!-- Form content on the right side -->
        <div id="formContainer" class="form-content">
           <div id="fixedFields">
              <!-- Campo fijo "Remitos desde" -->
              <div id="divFechaDesde" style="position: relative;">
                <label for="fechaDesde" class="field-label">Desde fecha</label>
                <input 
                  type="date" 
                  id="fechaDesde" 
                  name="fechaDesde" 
                  class="input-box" 
                  placeholder="Remitos desde"
                />
              </div>
            </div>

            <!-- Page Size Selection -->
            <div id="pageSizeContainer" style="margin-top: 15px;">
              <label for="pageSizeMenuSelect" class="field-label">Registros por página</label>
              <select id="pageSizeMenuSelect" class="input-box">
                <option value="10">10 registros</option>
                <option value="15">15 registros</option>
                <option value="25">25 registros</option>
                <option value="50" selected>50 registros</option>
                <option value="100">100 registros</option>
                <option value="200">200 registros</option>
                <option value="500">500 registros</option>
              </select>
            </div>

      <div class="form-container">
            <div id="dynamicFields">
              <!-- Campos dinámicos según puesto -->
            </div>
          <!-- contenido dinámico -->
        </div>
        </div> <!-- Close form-content -->
      </div> <!-- Close sidebar-layout -->
    </nav>

  </div>

  <!-- Preferences Modal -->
  <div id="preferencesModal" class="preferences-modal">
    <div class="preferences-content">
      <div class="preferences-header">
        <h2>Preferencias Visuales</h2>
        <button id="closePreferences" class="close-btn">×</button>
      </div>

      <!-- Logo Section -->
      <div class="preference-section">
        <div class="section-header">
          <h3>Logo</h3>
          <div style="display: flex; align-items: center; gap: 10px; flex: 1;">
            <img id="currentLogo" src="assets/logo-fondo-blanco.jpg" alt="Logo actual" class="current-logo" style="height: 40px; width: auto;">
          </div>
          <div style="display: flex; gap: 8px;">
            <label class="upload-btn">
              Cambiar logo
              <input type="file" id="logoUpload" accept="image/*" style="display: none;">
            </label>
            <button id="resetLogo" class="upload-btn" style="background: #6b7280;">
              Usar por defecto
            </button>
          </div>
        </div>
      </div>

      <!-- Theme Section -->
      <div class="preference-section">
        <div class="section-header">
          <h3>Tema</h3>
          <div class="inline-color-grid" id="colorThemes">
            <div class="color-option selected" data-theme="default" style="background: linear-gradient(45deg, #003e7e, #1c5fbf)" title="Azul Ottech (Por defecto)"></div>
            <div class="color-option" data-theme="emerald" style="background: linear-gradient(45deg, #065f46, #10b981)" title="Verde Esmeralda"></div>
            <div class="color-option" data-theme="purple" style="background: linear-gradient(45deg, #581c87, #8b5cf6)" title="Púrpura Elegante"></div>
            <div class="color-option" data-theme="orange" style="background: linear-gradient(45deg, #c2410c, #f97316)" title="Naranja Vibrante"></div>
            <div class="color-option" data-theme="rose" style="background: linear-gradient(45deg, #be185d, #f43f5e)" title="Rosa Moderno"></div>
            <div class="color-option" data-theme="slate" style="background: linear-gradient(45deg, #374151, #6b7280)" title="Gris Profesional"></div>
            <input type="color" id="customThemePicker" style="width: 30px; height: 30px; border: none; border-radius: 4px; cursor: pointer;">
            <input type="text" id="customThemeCode" placeholder="#3B82F6" class="input-box" maxlength="7" pattern="^#?[0-9A-Fa-f]{6}$" style="width: 80px; font-size: 0.85em; padding: 4px 6px;">
            <div class="color-option custom-preview" id="themePreview" style="width: 30px; height: 30px; background: #3B82F6;" title="Color de Tema"></div>
          </div>
        </div>
      </div>

      <!-- Background Section -->
      <div class="preference-section">
        <div class="section-header">
          <h3>Fondo</h3>
          <div class="inline-color-grid" id="backgroundOptions">
            <div class="color-option" data-bg="white" style="background: #ffffff; border: 2px solid #ddd;" title="Blanco"></div>
            <div class="color-option" data-bg="light-gray" style="background: #f8fafc;" title="Gris Claro"></div>
            <div class="color-option" data-bg="blue-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" title="Degradado Azul"></div>
            <div class="color-option" data-bg="sunset" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);" title="Atardecer"></div>
            <div class="color-option" data-bg="forest" style="background: linear-gradient(135deg, #134e5e 0%, #71b280 100%);" title="Bosque"></div>
            <div class="color-option" data-bg="ocean" style="background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);" title="Océano"></div>
            <input type="color" id="customBackgroundPicker" style="width: 30px; height: 30px; border: none; border-radius: 4px; cursor: pointer;">
            <input type="text" id="customBackgroundCode" placeholder="#F3F4F6" class="input-box" maxlength="7" pattern="^#?[0-9A-Fa-f]{6}$" style="width: 80px; font-size: 0.85em; padding: 4px 6px;">
            <div class="color-option custom-preview" id="backgroundPreview" style="width: 30px; height: 30px; background: #F3F4F6;" title="Color de Fondo"></div>
          </div>
        </div>
        <div style="margin-top: 10px; text-align: center;">
          <label class="upload-btn">
            Subir imagen
            <input type="file" id="backgroundUpload" accept="image/*" style="display: none;">
          </label>
        </div>
      </div>

      <!-- Save Section -->
      <div class="preference-section">
        <button id="savePreferences" style="width: 100%; background: var(--theme-primary); color: white; border: none; padding: var(--space-md); border-radius: var(--border-radius); cursor: pointer; font-size: 1rem;">
          Guardar Preferencias
        </button>
      </div>
    </div>
  </div>

  <script type="module" src="/lib/pdf/signMain.js"></script>
  <script type="module" src="/lib/ui/PreferencesHandler.js"></script>
  <script type="module" src="/lib/business/ClientTableConfigManager.js"></script>
</body>
</html>